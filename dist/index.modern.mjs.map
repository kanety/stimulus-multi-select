{"version":3,"file":"index.modern.mjs","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\nimport './index.scss';\n\nexport default class extends Controller {\n  static targets = ['src', 'dst'];\n  static values = {\n    maxOptions: Number,\n    sortOptions: { type: Boolean, default: false },\n    selectOnSubmit: { type: Boolean, default: true }\n  };\n  static actions = [\n    ['src', 'dblclick->add'],\n    ['src', 'keydown->addByKey'],\n    ['dst', 'dblclick->remove'],\n    ['dst', 'keydown->removeByKey']\n  ];\n\n  get form() {\n    return this.element.closest('form');\n  }\n\n  initialize() {\n    this._submit = this.submit.bind(this);\n  }\n\n  connect() {\n    if (this.selectOnSubmitValue && this.form) {\n      this.form.addEventListener('submit', this._submit);\n    }\n  }\n\n  disconnect() {\n    if (this.selectOnSubmitValue && this.form) {\n      this.form.removeEventListener('submit', this._submit);\n    }\n  }\n\n  submit(e) {\n    this.srcTarget.querySelectorAll('option').forEach(elem => elem.selected = false)\n    this.dstTarget.querySelectorAll('option').forEach(elem => elem.selected = true);\n  }\n\n  add(e) {\n    this.addOptions();\n  }\n\n  addByKey(e) {\n    if (e.keyCode == 13) {\n      e.preventDefault();\n      this.addOptions();\n    }\n  }\n\n  remove(e) {\n    this.removeOptions();\n  }\n\n  removeByKey(e) {\n    if (e.keyCode == 13) {\n      e.preventDefault();\n      this.removeOptions();\n    }\n  }\n\n  addOptions() {\n    this.srcTarget.querySelectorAll('option:checked').forEach(option => {\n      if (this.maxOptionsValue && this.dstTarget.querySelectorAll('option').length >= this.maxOptionsValue) {\n        return false;\n      }\n      this.addOption(option);\n    });\n\n    if (this.sortOptionsValue) this.sortOptions(this.dstTarget);\n  }\n\n  removeOptions() {\n    this.dstTarget.querySelectorAll('option:checked').forEach(option => {\n      this.removeOption(option);\n    });\n\n    if (this.sortOptionsValue) this.sortOptions(this.srcTarget);\n  }\n\n  addOption(option) {\n    option.selected = false;\n    this.dstTarget.append(option);\n    this.dispatch('added', { detail: { option: option } });\n  }\n\n  removeOption(option) {\n    option.selected = false;\n    this.srcTarget.append(option);\n    this.dispatch('removed', { detail: { option: option } });\n  }\n\n  sortOptions(target) {\n    let sorted = Array.from(target.querySelectorAll('option')).sort((a, b) => {\n      return a.value > b.value ? 1 : -1;\n    });\n    target.innerHTML = '';\n    target.append(...sorted);\n  }\n}\n"],"names":["_Class","Controller","form","this","element","closest","initialize","_submit","submit","bind","connect","selectOnSubmitValue","addEventListener","disconnect","removeEventListener","e","srcTarget","querySelectorAll","forEach","elem","selected","dstTarget","add","addOptions","addByKey","keyCode","preventDefault","remove","removeOptions","removeByKey","option","maxOptionsValue","length","addOption","sortOptionsValue","sortOptions","removeOption","append","dispatch","detail","target","sorted","Array","from","sort","a","b","value","innerHTML","targets","values","maxOptions","Number","type","Boolean","default","selectOnSubmit","actions"],"mappings":"wFAIe,MAAAA,UAAcC,EAc3B,QAAIC,GACF,OAAWC,KAACC,QAAQC,QAAQ,OAC9B,CAEAC,UAAAA,GACEH,KAAKI,QAAUJ,KAAKK,OAAOC,KAAKN,KAClC,CAEAO,OAAAA,GACMP,KAAKQ,qBAAuBR,KAAKD,MACnCC,KAAKD,KAAKU,iBAAiB,SAAUT,KAAKI,QAE9C,CAEAM,UAAAA,GACMV,KAAKQ,qBAAuBR,KAAKD,MACnCC,KAAKD,KAAKY,oBAAoB,SAAUX,KAAKI,QAEjD,CAEAC,MAAAA,CAAOO,GACLZ,KAAKa,UAAUC,iBAAiB,UAAUC,QAAQC,GAAQA,EAAKC,UAAW,GAC1EjB,KAAKkB,UAAUJ,iBAAiB,UAAUC,QAAQC,GAAQA,EAAKC,UAAW,EAC5E,CAEAE,GAAAA,CAAIP,GACFZ,KAAKoB,YACP,CAEAC,QAAAA,CAAST,GACU,IAAbA,EAAEU,UACJV,EAAEW,iBACFvB,KAAKoB,aAET,CAEAI,MAAAA,CAAOZ,GACLZ,KAAKyB,eACP,CAEAC,WAAAA,CAAYd,GACO,IAAbA,EAAEU,UACJV,EAAEW,iBACFvB,KAAKyB,gBAET,CAEAL,UAAAA,GACEpB,KAAKa,UAAUC,iBAAiB,kBAAkBC,QAAQY,IACxD,GAAI3B,KAAK4B,iBAAmB5B,KAAKkB,UAAUJ,iBAAiB,UAAUe,QAAU7B,KAAK4B,gBACnF,OAAO,EAET5B,KAAK8B,UAAUH,EAAM,GAGnB3B,KAAK+B,kBAAkB/B,KAAKgC,YAAYhC,KAAKkB,UACnD,CAEAO,aAAAA,GACEzB,KAAKkB,UAAUJ,iBAAiB,kBAAkBC,QAAQY,IACxD3B,KAAKiC,aAAaN,EACpB,GAEI3B,KAAK+B,kBAAkB/B,KAAKgC,YAAYhC,KAAKa,UACnD,CAEAiB,SAAAA,CAAUH,GACRA,EAAOV,UAAW,EAClBjB,KAAKkB,UAAUgB,OAAOP,GACtB3B,KAAKmC,SAAS,QAAS,CAAEC,OAAQ,CAAET,OAAQA,IAC7C,CAEAM,YAAAA,CAAaN,GACXA,EAAOV,UAAW,EAClBjB,KAAKa,UAAUqB,OAAOP,GACtB3B,KAAKmC,SAAS,UAAW,CAAEC,OAAQ,CAAET,OAAQA,IAC/C,CAEAK,WAAAA,CAAYK,GACV,IAAIC,EAASC,MAAMC,KAAKH,EAAOvB,iBAAiB,WAAW2B,KAAK,CAACC,EAAGC,IAC3DD,EAAEE,MAAQD,EAAEC,MAAQ,GAAK,GAElCP,EAAOQ,UAAY,GACnBR,EAAOH,UAAUI,EACnB,EACDzC,EAlGQiD,QAAU,CAAC,MAAO,OAAMjD,EACxBkD,OAAS,CACdC,WAAYC,OACZjB,YAAa,CAAEkB,KAAMC,QAASC,SAAS,GACvCC,eAAgB,CAAEH,KAAMC,QAASC,SAAS,IAC3CvD,EACMyD,QAAU,CACf,CAAC,MAAO,iBACR,CAAC,MAAO,qBACR,CAAC,MAAO,oBACR,CAAC,MAAO"}