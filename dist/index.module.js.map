{"version":3,"file":"index.module.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\nimport './index.scss';\n\nexport default class extends Controller {\n  static targets = ['src', 'dst'];\n  static values = {\n    maxOptions: Number,\n    sortOptions: { type: Boolean, default: false },\n    selectOnSubmit: { type: Boolean, default: true }\n  };\n  static actions = [\n    ['src', 'dblclick->add'],\n    ['src', 'keydown->addByKey'],\n    ['dst', 'dblclick->remove'],\n    ['dst', 'keydown->removeByKey']\n  ];\n\n  get form() {\n    return this.element.closest('form');\n  }\n\n  initialize() {\n    this._submit = this.submit.bind(this);\n  }\n\n  connect() {\n    if (this.selectOnSubmitValue && this.form) {\n      this.form.addEventListener('submit', this._submit);\n    }\n  }\n\n  disconnect() {\n    if (this.selectOnSubmitValue && this.form) {\n      this.form.removeEventListener('submit', this._submit);\n    }\n  }\n\n  submit(e) {\n    this.srcTarget.querySelectorAll('option').forEach(elem => elem.selected = false)\n    this.dstTarget.querySelectorAll('option').forEach(elem => elem.selected = true);\n  }\n\n  add(e) {\n    this.addOptions();\n  }\n\n  addByKey(e) {\n    if (e.keyCode == 13) {\n      e.preventDefault();\n      this.addOptions();\n    }\n  }\n\n  remove(e) {\n    this.removeOptions();\n  }\n\n  removeByKey(e) {\n    if (e.keyCode == 13) {\n      e.preventDefault();\n      this.removeOptions();\n    }\n  }\n\n  addOptions() {\n    this.srcTarget.querySelectorAll('option:checked').forEach(option => {\n      if (this.maxOptionsValue && this.dstTarget.querySelectorAll('option').length >= this.maxOptionsValue) {\n        return false;\n      }\n      this.addOption(option);\n    });\n\n    if (this.sortOptionsValue) this.sortOptions(this.dstTarget);\n  }\n\n  removeOptions() {\n    this.dstTarget.querySelectorAll('option:checked').forEach(option => {\n      this.removeOption(option);\n    });\n\n    if (this.sortOptionsValue) this.sortOptions(this.srcTarget);\n  }\n\n  addOption(option) {\n    option.selected = false;\n    this.dstTarget.append(option);\n    this.dispatch('added', { detail: { option: option } });\n  }\n\n  removeOption(option) {\n    option.selected = false;\n    this.srcTarget.append(option);\n    this.dispatch('removed', { detail: { option: option } });\n  }\n\n  sortOptions(target) {\n    let sorted = Array.from(target.querySelectorAll('option')).sort((a, b) => {\n      return a.value > b.value ? 1 : -1;\n    });\n    target.innerHTML = '';\n    target.append(...sorted);\n  }\n}\n"],"names":["Controller","form","element","closest","initialize","this","_submit","submit","bind","connect","selectOnSubmitValue","addEventListener","disconnect","removeEventListener","e","srcTarget","querySelectorAll","forEach","elem","selected","dstTarget","add","addOptions","addByKey","keyCode","preventDefault","remove","removeOptions","removeByKey","option","maxOptionsValue","length","addOption","sortOptionsValue","sortOptions","removeOption","append","dispatch","detail","target","sorted","Array","from","sort","a","b","value","innerHTML","targets","values","maxOptions","Number","type","Boolean","default","selectOnSubmit","actions"],"mappings":"wGAI6BA,EAcvBC,WACF,YAAYC,QAAQC,QAAQ,QAG9BC,aACEC,KAAKC,QAAUD,KAAKE,OAAOC,KAAKH,MAGlCI,UACMJ,KAAKK,qBAAuBL,KAAKJ,MACnCI,KAAKJ,KAAKU,iBAAiB,SAAUN,KAAKC,SAI9CM,aACMP,KAAKK,qBAAuBL,KAAKJ,MACnCI,KAAKJ,KAAKY,oBAAoB,SAAUR,KAAKC,SAIjDC,OAAOO,GACLT,KAAKU,UAAUC,iBAAiB,UAAUC,QAAQC,GAAQA,EAAKC,UAAW,GAC1Ed,KAAKe,UAAUJ,iBAAiB,UAAUC,QAAQC,GAAQA,EAAKC,UAAW,GAG5EE,IAAIP,GACFT,KAAKiB,aAGPC,SAAST,GACU,IAAbA,EAAEU,UACJV,EAAEW,iBACFpB,KAAKiB,cAITI,OAAOZ,GACLT,KAAKsB,gBAGPC,YAAYd,GACO,IAAbA,EAAEU,UACJV,EAAEW,iBACFpB,KAAKsB,iBAITL,aACEjB,KAAKU,UAAUC,iBAAiB,kBAAkBC,QAAQY,IACxD,GAAIxB,KAAKyB,iBAAmBzB,KAAKe,UAAUJ,iBAAiB,UAAUe,QAAU1B,KAAKyB,gBACnF,SAEFzB,KAAK2B,UAAUH,KAGbxB,KAAK4B,kBAAkB5B,KAAK6B,YAAY7B,KAAKe,WAGnDO,gBACEtB,KAAKe,UAAUJ,iBAAiB,kBAAkBC,QAAQY,IACxDxB,KAAK8B,aAAaN,KAGhBxB,KAAK4B,kBAAkB5B,KAAK6B,YAAY7B,KAAKU,WAGnDiB,UAAUH,GACRA,EAAOV,UAAW,EAClBd,KAAKe,UAAUgB,OAAOP,GACtBxB,KAAKgC,SAAS,QAAS,CAAEC,OAAQ,CAAET,OAAQA,KAG7CM,aAAaN,GACXA,EAAOV,UAAW,EAClBd,KAAKU,UAAUqB,OAAOP,GACtBxB,KAAKgC,SAAS,UAAW,CAAEC,OAAQ,CAAET,OAAQA,KAG/CK,YAAYK,GACV,IAAIC,EAASC,MAAMC,KAAKH,EAAOvB,iBAAiB,WAAW2B,KAAK,CAACC,EAAGC,IAC3DD,EAAEE,MAAQD,EAAEC,MAAQ,GAAK,GAElCP,EAAOQ,UAAY,GACnBR,EAAOH,UAAUI,MAhGZQ,QAAU,CAAC,MAAO,SAClBC,OAAS,CACdC,WAAYC,OACZjB,YAAa,CAAEkB,KAAMC,QAASC,SAAS,GACvCC,eAAgB,CAAEH,KAAMC,QAASC,SAAS,MAErCE,QAAU,CACf,CAAC,MAAO,iBACR,CAAC,MAAO,qBACR,CAAC,MAAO,oBACR,CAAC,MAAO"}